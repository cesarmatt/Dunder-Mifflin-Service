AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'trabalhofinal

  Sample SAM Template for trabalhofinal

  '
Globals:
  Function:
    Timeout: 20
Resources:
  SaveCustomerService:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: SaveCustomerService
      Handler: savecustomer.App::handleRequest
      Runtime: java11
      MemorySize: 512
      Environment:
        Variables:
          PARAM1: VALUE
      Events:
        SaveCustomer:
          Type: Api
          Properties:
            Path: /customer
            Method: post
      Policies:
      - Statement:
        - Sid: DynamoDBWritePolicy
          Effect: Allow
          Action:
          - dynamodb:*
          Resource:
          - Fn::Sub: arn:${AWS::Partition}:dynamodb:${AWS::Region}:${AWS::AccountId}:table/customer
  GetCustomerService:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: GetCustomerService
      Handler: getcustomer.App::handleRequest
      Runtime: java11
      MemorySize: 512
      Environment:
        Variables:
          PARAM1: VALUE
      Events:
        GetCustomer:
          Type: Api
          Properties:
            Path: /customer
            Method: get
      Policies:
      - Statement:
        - Sid: DynamoDBWritePolicy
          Effect: Allow
          Action:
          - dynamodb:*
          Resource:
          - Fn::Sub: arn:${AWS::Partition}:dynamodb:${AWS::Region}:${AWS::AccountId}:table/customer
Outputs:
  SaveCustomerApi:
    Description: API Gateway endpoint URL for Prod stage for Save Customer function
    Value:
      Fn::Sub: https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/savecustomer/
  SaveCustomerFunction:
    Description: Save Customer Lambda Function ARN
    Value:
      Fn::GetAtt:
      - SaveCustomerService
      - Arn
  SaveCustomerFunctionIamRole:
    Description: Implicit IAM Role created for Save Customer function
    Value:
      Fn::GetAtt:
      - SaveCustomerServiceRole
      - Arn
